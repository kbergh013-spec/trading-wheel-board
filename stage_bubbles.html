<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Trading Wheels – Stage Bubbles</title>
<style>
  :root{
    --panel: rgba(24,28,36,0.18);
    --text:#eaf0ff;
    --accent:#50e3c2;
    --wm-opacity:.85;
  }
  html,body{
    margin:0;
    background:transparent;
    color:var(--text);
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
  }

  /* Background image */
  .wm{
    position:fixed;
    inset:0;
    z-index:0;
    pointer-events:none;
  }
  .wm img{
    width:100vw;
    height:100vh;
    object-fit:cover;
    opacity:var(--wm-opacity);
    filter:none;
  }

  /* Header (top bar) */
  header{
    position:relative;
    z-index:1;
    display:flex;
    align-items:center;
    gap:10px;
    padding:12px 16px 4px;
  }
  .logos{display:flex;align-items:center;gap:8px}
  img.logo{height:34px;display:none}
  img.logo.stock{height:26px;opacity:.9}
  h1{
    margin:0;
    font-size:26px;
    font-weight:800;
    letter-spacing:.4px;
  }

  /* Main card */
  .wrap{
    position:relative;
    z-index:1;
    padding:8px 16px 16px;
  }
  .card{
    background:rgba(24,28,36,0.15);  /* was 0.30 — now lighter and more see-through */
    border:1px solid #2a3346;
    border-radius:16px;
    padding:18px;
    max-width:1800px;
    margin:0 auto;
    transform: translateX(-40px);
  }

  /* Neon category title */
  #cardTitle{
    margin:0 0 20px;
    font-size:32px;
    font-weight:900;
    text-align:center;
    color:var(--accent);
    text-shadow:0 0 18px rgba(80,227,194,0.9);
    letter-spacing:.5px;
  }

  .chips{
    display:grid;
    gap:4vh 4vw; /* default row gap, column gap */
  }

  /* Base bubble style */
  .chip{
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:999px;
    border:1px solid #2b3447;
    background:rgba(30,37,51,0.10);  /* was solid #1e2533 — now 60% opaque */
    font-weight:900;
    letter-spacing:.45px;
    color:var(--text);
    padding:16px 10px;
    font-size:36px;
  }
  .chip.taken{
    background: rgba(38, 23, 26, 0.4) !important;
    border-color:#3b1f24;
    color:#ffdede;
  }

  /* Size variants controlled by data-size on <html> */
  html[data-size="xl"] .chip{
    font-size:52px;
    padding:24px 50px;
  }
  html[data-size="lg"] .chip{
    font-size:42px;
    padding:20px 40px;
  }
  html[data-size="md"] .chip{
    font-size:32px;
    padding:16px 32px;
  }

  /* Extra spacing based on size */
  /* QB uses size=xl so this affects QB only */
  html[data-size="xl"] .chips{
    gap:18vh 8vw;  /* vertical, horizontal – tweak 14 up/down for QB row spacing */
  }
  html[data-size="lg"] .chips{
    gap:10vh 6vw;
  }
  html[data-size="md"] .chips{
    gap:8vh 5vw;
  }
/* Center QB section vertically */
html[data-cat="qb"] body {
  display: flex;
  flex-direction: column;
  justify-content: center;
  min-height: 100vh;  /* fill full screen height */
}

html[data-cat="qb"] .wrap {
  flex-grow: 1; /* allows the card to center vertically */
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0; /* remove top padding that pushes it down */
}

html[data-cat="qb"] .card {
  margin: 0 auto;
}
/* hide both logos globally */
.logos {
  display: none !important;
}

  @media (max-width: 1400px){
    .chip{font-size:90%}
  }

  /* RB page only — make chips a bit smaller and closer so they fit on screen */
html[data-cat="rb"] .chip {
  font-size: 30px;      /* was 36 / 42 / 52 depending on size */
  padding: 12px 28px;   /* less vertical padding = shorter bubbles */
}

/* RB grid spacing — less vertical gap so more rows fit */
html[data-cat="rb"] .chips {
  gap: 7vh 4vw;         /* vertical, horizontal spacing */
}

/* Optional: shrink the RB card padding a bit to gain more height */
html[data-cat="rb"] .card {
  padding-top: 10px;
  padding-bottom: 10px;
}

  /* Make chips semi-transparent on every page */
.chip {
  background: rgba(30, 37, 51, 0.55);  /* 0.55 = 55 % solid, 45 % see-through */
}

/* If you want the text to pop a bit more on transparent chips */
.chip {
  color: rgba(234, 240, 255, 0.95);    /* slight fade on text for polish */
}
  html[data-cat="rb"] .chip,
html[data-cat="wr"] .chip,
html[data-cat="te"] .chip,
html[data-cat="def"] .chip {
  background: rgba(30, 37, 51, 0.45);
}

  /* Slightly more transparent chips for crowded categories */
html[data-cat="rb"] .chip,
html[data-cat="wr"] .chip,
html[data-cat="te"] .chip,
html[data-cat="def"] .chip {
  background: rgba(30, 37, 51, 0.38); /* was ~0.5; this lets background show more */
}
/* Lift RB and WR boards up slightly so they don't cover the public.com logo */
html[data-cat="rb"] .card,
html[data-cat="wr"] .card {
  transform: translate(-60px, -50px);  /* try -30px first; adjust if needed */
}

/* Move the top-right chips left so they don't sit under the Trading Wheels logo */

/* RB – chips in 4th col, rows 1 & 2 */
html[data-cat="rb"] .chips > .chip:nth-child(4),
html[data-cat="rb"] .chips > .chip:nth-child(8),

/* WR – chips in 4th col, rows 1 & 2 */
html[data-cat="wr"] .chips > .chip:nth-child(4),
html[data-cat="wr"] .chips > .chip:nth-child(8),

/* TE – chips in 4th col, rows 1 & 2 */
html[data-cat="te"] .chips > .chip:nth-child(4),
html[data-cat="te"] .chips > .chip:nth-child(8),

/* DEF – chips in 4th col, rows 1 & 2 */
html[data-cat="def"] .chips > .chip:nth-child(4),
html[data-cat="def"] .chips > .chip:nth-child(8) {
  margin-right: 123px;   /* was 80px — pushes them farther left */
}




</style>
</head>
<body>
  <!-- Background -->
  <div class="wm"><img id="bg" alt="Background"></div>

  <header>
    <div class="logos">
      <img id="twLogo" class="logo" alt="Trading Wheels">
      <img id="xLogo"  class="logo stock" alt="X logo">
    </div>
    <h1>Trading Wheels Fantasy Stock Ball — Live Draft Board</h1>
  </header>

  <div class="wrap">
    <div class="card">
      <h2 id="cardTitle"></h2>
      <div id="chips" class="chips"></div>
    </div>
  </div>

<script>
/* ---------- CONFIG ---------- */

const SHEET_ID = "10eCZI1tLui-KwHQDRFRnsZXghM_jf5MX8zdlCZkI-Os";

/* Per-category settings */
const CATS = {
  qb: {
    key:   "qb",
    title: "QB (MAG7 + NFLX)",
    size:  "xl",   // biggest chips (QB only)
    cols:  4
  },
  rb: {
    key:   "rb",
    title: "RB (Dow 30)",
    size:  "lg",
    cols:  4
  },
  wr: {
    key:   "wr",
    title: "WR (Growth)",
    size:  "lg",
    cols:  4
  },
  te: {
    key:   "te",
    title: "TE (International)",
    size:  "md",
    cols:  4
  },
  def: {
    key:   "def",
    title: "Defense (Defensive)",
    size:  "md",
    cols:  4
  }
};

/* ---------- PARAMS ---------- */

const params = new URLSearchParams(location.search);
const catParam = (params.get("cat") || "qb").toLowerCase();
const cfg = CATS[catParam] || CATS.qb;

document.documentElement.setAttribute("data-size", cfg.size);
// data-cat is set but not used right now – safe to keep for future tweaks
document.documentElement.setAttribute("data-cat", cfg.key);

const TW_LOGO  = "Trading Wheels.png";
const X_LOGO   = "stock_logo.png";
const BG_IMAGE = "Fantasy_Background.png";

/* Build the Google Sheets CSV URL for this category */
const tq  = encodeURIComponent(`select A,B,C,E,F where A='${cfg.key}'`);
const CSV_URL =
  `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tq=${tq}&tqx=out:csv`;

/* ---------- STATIC UI ---------- */

document.getElementById("cardTitle").textContent = cfg.title;

const twLogoEl = document.getElementById("twLogo");
const xLogoEl  = document.getElementById("xLogo");
const bgEl     = document.getElementById("bg");

twLogoEl.src = TW_LOGO;  twLogoEl.style.display = "block";
xLogoEl.src  = X_LOGO;   xLogoEl.style.display  = "block";
bgEl.src     = BG_IMAGE;

/* ---------- CSV PARSE ---------- */

function parseCSV(text){
  text = text.replace(/^\uFEFF/, "");
  const lines = text.split(/\r?\n/).filter(Boolean);
  const rows  = [];
  for(const line of lines){
    let inQ = false, cur = "", cells = [];
    for(let i=0; i<line.length; i++){
      const ch = line[i];
      if(ch === '"'){
        if(inQ && line[i+1] === '"'){ cur += '"'; i++; }
        else inQ = !inQ;
      }else if(ch === ',' && !inQ){
        cells.push(cur); cur="";
      }else{
        cur += ch;
      }
    }
    cells.push(cur);
    rows.push(cells);
  }
  return rows;
}

/* ---------- RENDER ---------- */

function render(rows){
  const box = document.getElementById("chips");
  box.innerHTML = "";

  box.style.gridTemplateColumns = `repeat(${cfg.cols}, 1fr)`;

  for(const r of rows){
    const key = (r[0]||"").trim().toLowerCase();
    if(key === "title" || key === "category_key") continue;

    const sym   = (r[2]||"").trim();
    if(!sym) continue;
    const taken = (r[4]||"").toString().trim().toLowerCase();
    const isTaken = (taken==="1"||taken==="true"||taken==="yes"||taken==="y");

    const el = document.createElement("div");
    el.className = "chip" + (isTaken ? " taken" : "");
    el.textContent = sym;
    box.appendChild(el);
  }
}

/* ---------- POLLING ---------- */

async function sync(){
  try{
    const res = await fetch(
      CSV_URL + (CSV_URL.includes("?") ? "&" : "?") + "cachebust=" + Date.now()
    );
    const txt = await res.text();
    const rows = parseCSV(txt);
    render(rows);
  }catch(e){
    console.error(e);
  }
}
sync();
setInterval(sync, 5000);
</script>
</body>
</html>
