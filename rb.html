<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>RB — Dow 30</title>
<style>
  :root{
    --panel: rgba(24,28,36,0.30);
    --text:#eaf0ff;
    --accent:#50e3c2;
    --chip:#1e2533;
    --chip-border:#2b3447;
    --wm-opacity:.85;
  }
  html,body{
    margin:0;background:transparent;color:var(--text);
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
  }
  .wm{position:fixed;inset:0;z-index:0;pointer-events:none}
  .wm img{width:100vw;height:100vh;object-fit:cover;opacity:var(--wm-opacity);filter:none}
  header{
    position:relative;z-index:1;
    display:flex;align-items:center;gap:10px;
    padding:12px 16px 4px;
  }
  .logos{display:flex;align-items:center;gap:8px}
  img.logo{height:34px;display:none}
  img.logo.stock{height:26px;opacity:.9}
  h1{margin:0;font-size:26px;font-weight:800;letter-spacing:.4px}
  .wrap{position:relative;z-index:1;padding:8px 16px 16px}
  .card{
    background:var(--panel);border:1px solid #2a3346;border-radius:16px;
    padding:18px;max-width:1700px;margin:0 auto;
  }
  .card h2{margin:0 0 14px;font-size:20px;color:var(--accent)}
  .chips{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:12px;
  }
  .chip{
    display:flex;align-items:center;justify-content:center;
    padding:16px 8px;
    background:var(--chip);
    border:1px solid var(--chip-border);
    border-radius:999px;
    font-weight:900;
    font-size:34px;
    letter-spacing:.4px;
  }
  .chip.taken{
    background:#26171a;border-color:#3b1f24;color:#ffdede;
  }
  @media(max-width:1400px){
    .chip{font-size:30px}
  }
</style>
</head>
<body>
  <div class="wm"><img id="bg" alt="Background"></div>

  <header>
    <div class="logos">
      <img id="twLogo" class="logo" alt="Trading Wheels">
      <img id="xLogo"  class="logo stock" alt="X">
    </div>
    <h1>RB — Dow 30</h1>
  </header>

  <div class="wrap">
    <div class="card">
      <h2>RB (Dow 30) — Pick 2</h2>
      <div id="chips" class="chips"></div>
    </div>
  </div>

<script>
const SHEET_ID = "10eCZI1tLui-KwHQDRFRnsZXghM_jf5MX8zdlCZkI-Os";
const CSV = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?` +
            `tq=${encodeURIComponent("select A,B,C,E,F where A='rb'")}&tqx=out:csv`;

document.getElementById('twLogo').src = "Trading Wheels.png";
document.getElementById('twLogo').style.display = "block";
document.getElementById('xLogo').src  = "stock_logo.png";
document.getElementById('xLogo').style.display  = "block";
document.getElementById('bg').src     = "Fantasy_Background.png";

function parseCSV(t){
  t = t.replace(/^\uFEFF/, "");
  const lines = t.split(/\r?\n/).filter(Boolean);
  const rows = [];
  for(const line of lines){
    let inQ=false, cur="", cells=[];
    for(let i=0;i<line.length;i++){
      const ch=line[i];
      if(ch === '"'){
        if(inQ && line[i+1] === '"'){ cur+='"'; i++; }
        else inQ = !inQ;
      }else if(ch === ',' && !inQ){
        cells.push(cur); cur="";
      }else cur+=ch;
    }
    cells.push(cur);
    rows.push(cells);
  }
  return rows;
}

function render(rows){
  const box = document.getElementById('chips');
  box.innerHTML = "";
  for(const r of rows){
    const k = (r[0]||"").toLowerCase().trim();
    if(k === "title" || k === "category_key") continue;
    const sym = (r[2]||"").trim();
    if(!sym) continue;
    const taken = (r[4]||"").toString().trim().toLowerCase();
    const isTaken = (taken==="1"||taken==="true"||taken==="yes"||taken==="y");
    const el = document.createElement('div');
    el.className = "chip" + (isTaken ? " taken" : "");
    el.textContent = sym;
    box.appendChild(el);
  }
}

async function sync(){
  try{
    const res = await fetch(CSV + "&cachebust=" + Date.now());
    const txt = await res.text();
    render(parseCSV(txt));
  }catch(e){ console.error(e); }
}
sync();
setInterval(sync, 5000);
</script>
</body>
</html>
